<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>mapShow</title>
    <style>
        body {
          position: absolute;
          top: 0;
          bottom: 0;
          left: 0;
          right: 0;
          margin: 0;
        }
        iframe {
          width: 100%;
          height: 100%;
        }
        * {
          margin: 0;
          padding: 0;
        }
      </style>
    <!-- URL: https://m.amap.com/navi/?dest=115.482989,38.813949&destName=您&hideRouteIcon=1&key=（您的Key）&jscode=（您的安全密钥） -->
    <!-- <script src="https://webapi.amap.com/maps?v=2.0&key=81a6b00d842f4e6dd307a9bbaaa2cdf2"></script> -->
</head>
<body>
    <iframe
    id="test"
    src=""
  ></iframe>
  
  <script>
    (async function() {
      // 定义原始经纬度（假设是 GPS 坐标）
      let latitude = '38.813949';
      let longitude = '115.482989';
  
      // 更新经纬度值
      latitude = '38.813949';
      longitude = '115.482989';
  
      // 构造高德地图 API 的 URL，用于坐标转换
      const covertUrl = `https://restapi.amap.com/v3/assistant/coordinate/convert?key=880a3a07f80d9e38fd41b5f96d0e3e30&locations=${longitude},${latitude}&coordsys=gps`;
  
      // 请求高德地图 API 进行坐标转换
      try {
        const response = await fetch(covertUrl);
        console.log(response);
        
        const resJson = await response.json();
        const { locations } = resJson;
        
        // 确保转换成功
        if (locations) {
          [longitude, latitude] = locations.split(',');
        } else {
          console.error("坐标转换失败，使用原始坐标。");
        }
      } catch (err) {
        console.error("请求坐标转换API失败:", err);
      }
  
      // 构造 URL
      const url = `https://m.amap.com/navi/?dest=${longitude},${latitude}&destName=您&hideRouteIcon=1&key=81a6b00d842f4e6dd307a9bbaaa2cdf2&jscode=587bb7c81a85b856287d943d4b9f0981`;
  
      // 设置 iframe 的 src 属性
      const iframe = document.getElementById("test");
      iframe.src = url;
  
      // 在 iframe 加载完成后，发送消息
      iframe.onload = function() {
        // iframe.contentWindow.postMessage("hello", "https://m.amap.com/picker/");
      };
  
      // 监听消息
    //   window.addEventListener(
    //     "message",
    //     function(e) {
    //       // 处理接收到的消息
    //       console.log("Received message:", e.data);
    //     },
    //     false
    //   );
    })();
  </script>
  
</body>
</html>